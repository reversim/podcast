---
import { withBase } from '../lib/urls';

const siteBase = import.meta.env.SITE ?? 'https://reversim.github.io';
const podcastFeed = new URL(withBase('/podcast.xml'), siteBase).toString();
const title = 'רברס עם פלטפורמה';

const links = [
	{ href: `itpc://${podcastFeed.replace(/^https?:\/\//, '')}`, label: 'Apple Podcasts', kind: 'apple' },
	{
		href: `pktc://subscribe/${podcastFeed.replace(/^https?:\/\//, '')}`,
		label: 'Pocket Casts',
		kind: 'pocketcasts',
	},
	{
		href: `overcast://x-callback-url/add?url=${encodeURIComponent(podcastFeed)}`,
		label: 'Overcast',
		kind: 'overcast',
	},
	{
		href: `https://antennapod.org/deeplink/subscribe?url=${encodeURIComponent(podcastFeed)}&title=${encodeURIComponent(title)}`,
		label: 'AntennaPod',
		external: true,
		kind: 'antennapod',
	},
	{ href: `pcast://${podcastFeed.replace(/^https?:\/\//, '')}`, label: 'Any App', kind: 'app' },
	{ href: withBase('/podcast.xml'), label: 'Podcast RSS', kind: 'rss' },
];
---

<div class="subscribe-strip" aria-label="קישורי הרשמה לפודקאסט">
	<span class="subscribe-label">הרשמה:</span>
	{links.map((item) => (
		<a
			class={`subscribe-link subscribe-${item.kind}`}
			href={item.href}
			target={item.external ? '_blank' : undefined}
			rel={item.external ? 'noreferrer noopener' : undefined}
		>
			<span class="subscribe-icon" aria-hidden="true">
				{
					item.kind === 'apple' && (
						<svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
							<circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="1.8" />
							<circle cx="12" cy="12" r="5.3" fill="none" stroke="currentColor" stroke-width="1.8" />
							<circle cx="12" cy="12" r="1.9" />
						</svg>
					)
				}
				{
					item.kind === 'pocketcasts' && (
						<svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
							<circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="1.8" />
							<path d="M12 8.1A3.9 3.9 0 0 0 8.1 12h1.8a2.1 2.1 0 1 1 2.1 2.1V18a6 6 0 1 0 0-9.9z" />
						</svg>
					)
				}
				{
					item.kind === 'overcast' && (
						<svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
							<circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="1.8" />
							<path d="M12 6.8a5.2 5.2 0 0 0-5.2 5.2 1 1 0 1 0 2 0 3.2 3.2 0 1 1 6.4 0c0 1.2-.7 2.3-1.8 2.8l-.8-2.5h-1.2l-1.5 4.9h4l-.5-1.7A5.2 5.2 0 0 0 17.2 12 5.2 5.2 0 0 0 12 6.8z" />
						</svg>
					)
				}
				{
					item.kind === 'rss' && (
						<svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
							<path d="M6.18 15.64a2.18 2.18 0 1 1-2.18 2.18 2.18 2.18 0 0 1 2.18-2.18zM4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27zm0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93z" />
						</svg>
					)
				}
				{
					(item.kind === 'app' || item.kind === 'antennapod') && (
						<svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
							<path d="M7 2h10a3 3 0 0 1 3 3v14a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V5a3 3 0 0 1 3-3zm0 2a1 1 0 0 0-1 1v12h12V5a1 1 0 0 0-1-1zm5 15a1.3 1.3 0 1 0 1.3 1.3A1.3 1.3 0 0 0 12 19.01z" />
						</svg>
					)
				}
			</span>
			{item.label}
		</a>
	))}
</div>

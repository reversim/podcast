---
import { withBase } from '../lib/urls';

const siteBase = import.meta.env.SITE ?? 'https://reversim.github.io';
const podcastFeed = new URL(withBase('/podcast.xml'), siteBase).toString();
const title = 'רברס עם פלטפורמה';

const links = [
	{ href: `itpc://${podcastFeed.replace(/^https?:\/\//, '')}`, label: 'Apple', kind: 'apple' },
	{
		href: `pktc://subscribe/${podcastFeed.replace(/^https?:\/\//, '')}`,
		label: 'Pocket Casts',
		kind: 'pocketcasts',
	},
	{
		href: `overcast://x-callback-url/add?url=${encodeURIComponent(podcastFeed)}`,
		label: 'Overcast',
		kind: 'overcast',
	},
	{
		href: `https://antennapod.org/deeplink/subscribe?url=${encodeURIComponent(podcastFeed)}&title=${encodeURIComponent(title)}`,
		label: 'AntennaPod',
		external: true,
		kind: 'antennapod',
	},
	{ href: `pcast://${podcastFeed.replace(/^https?:\/\//, '')}`, label: 'Any App', kind: 'app' },
	{ href: withBase('/podcast.xml'), label: 'Podcast RSS', kind: 'rss' },
	{ href: withBase('/rss.xml'), label: 'RSS', kind: 'rss' },
	{ href: withBase('/atom.xml'), label: 'Atom', kind: 'atom' },
];
---

<div class="subscribe-strip" aria-label="קישורי הרשמה לפודקאסט">
	<span class="subscribe-label">הרשמה:</span>
	{links.map((item) => (
		<a
			class={`subscribe-link subscribe-${item.kind}`}
			href={item.href}
			target={item.external ? '_blank' : undefined}
			rel={item.external ? 'noreferrer noopener' : undefined}
		>
			<span class="subscribe-icon" aria-hidden="true">
				{
					item.kind === 'apple' && (
						<svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
							<path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 14.5a4.5 4.5 0 1 1 0-9 4.5 4.5 0 0 1 0 9zm0-5.5a1 1 0 1 0 0 2 1 1 0 0 0 0-2z" />
						</svg>
					)
				}
				{
					item.kind === 'overcast' && (
						<svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
							<path d="M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2zm0 15.5a5.5 5.5 0 1 1 5.5-5.5A5.51 5.51 0 0 1 12 17.5zm0-8.7A3.2 3.2 0 0 0 8.8 12a1 1 0 0 0 2 0 1.2 1.2 0 1 1 2.4 0 1 1 0 0 0 2 0A3.2 3.2 0 0 0 12 8.8z" />
						</svg>
					)
				}
				{
					item.kind === 'pocketcasts' && (
						<svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
							<path d="M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2zm0 15a5 5 0 1 1 5-5 5 5 0 0 1-5 5zm0-8a3 3 0 0 0-3 3h2a1 1 0 1 1 1 1v2a3 3 0 0 0 0-6z" />
						</svg>
					)
				}
				{
					item.kind === 'rss' && (
						<svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
							<path d="M6.18 15.64a2.18 2.18 0 1 1-2.18 2.18 2.18 2.18 0 0 1 2.18-2.18zM4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27zm0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93z" />
						</svg>
					)
				}
				{
					item.kind === 'atom' && (
						<svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
							<path d="M12 2a2 2 0 1 1-2 2 2 2 0 0 1 2-2zm0 18a2 2 0 1 1-2 2 2 2 0 0 1 2-2zM4 12a2 2 0 1 1-2-2 2 2 0 0 1 2 2zm20 0a2 2 0 1 1-2-2 2 2 0 0 1 2 2zM7.1 7.1a1.3 1.3 0 0 1 0-1.8 1.3 1.3 0 0 1 1.8 0l8.8 8.8a1.3 1.3 0 0 1 0 1.8 1.3 1.3 0 0 1-1.8 0zM16.9 7.1l-8.8 8.8a1.3 1.3 0 1 1-1.8-1.8l8.8-8.8a1.3 1.3 0 0 1 1.8 1.8z" />
						</svg>
					)
				}
				{
					(item.kind === 'app' || item.kind === 'antennapod') && (
						<svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
							<path d="M7 2h10a3 3 0 0 1 3 3v14a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V5a3 3 0 0 1 3-3zm0 2a1 1 0 0 0-1 1v12h12V5a1 1 0 0 0-1-1zm5 15a1.3 1.3 0 1 0 1.3 1.3A1.3 1.3 0 0 0 12 19.01z" />
						</svg>
					)
				}
			</span>
			{item.label}
		</a>
	))}
</div>

---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getAllPosts, getPostPermalink } from '../lib/posts';

const posts = (await getAllPosts()).filter((post) => post.data.audio_url);
---

<BaseLayout title="פרקים | רברס עם פלטפורמה">
	<h1 class="section-title">פרקים עם אודיו</h1>
	<div class="posts-grid">
		{posts.map((post) => (
			<article class="post-card">
				<div class="post-meta">
					<span>{post.data.date.toLocaleDateString('he-IL')}</span>
					{post.data.episode && <span>פרק {post.data.episode}</span>}
				</div>
				<h3 dir="auto"><a href={getPostPermalink(post)} dir="auto">{post.data.title}</a></h3>
				{post.data.audio_url && (
					<div class="audio-player">
						<audio controls preload="none" src={post.data.audio_url}></audio>
					</div>
				)}
			</article>
		))}
	</div>
</BaseLayout>
